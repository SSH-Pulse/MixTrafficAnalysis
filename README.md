# MixTrafficGen

**MixTrafficGen** is a mixed traffic generation tool in the field of tunneled traffic analysis. This repository provides the implementation of our proposed algorithm, along with utilities for feature extraction and dataset generation.

## 🚀 Features
The proposed mixed traffic generation algorithm takes each packet and its label as a whole during the traffic mixing process. The tunneled traffic generated by the proposed algorithm can be labeled at both the flow and packet levels. The packet-level label provides the label of each packet and the proportion of target traffic in the mixed flow. 

- Implementation of **Algorithm 1** as described in our paper.
- Utilities to generate tunneled mixed traffic with **fine-grained packet-level labels**.
- Outputs include packet length, arrival time delta, and packet-level labels.
- Example configurations and usage scripts.

## 🚀 Dataset
We have established three tunnel datasets: Shadowsocks, Vmess, and Trojan, all of which employ encrypted encapsulation tunnels. By using the proposed algorithm to mix the traffic, we can obtain packet-level labels. The figure below shows the proportion of SSH traffic on the Trojan, Shadowsocks, and Vmess tunnel datasets.
![image](https://github.com/user-attachments/assets/5e058633-683d-451b-b795-3a3123fe2d8c)

- [Dataset Download Link](https://drive.google.com/drive/folders/1NMGLJ12LbhFJbVLc8550gjw-Y62RNNJH?usp=sharing)


## 📦 Installation

```bash
git clone https://github.com/SSH-Pulse/MixTrafficGen.git
cd MixTrafficGen
pip install -r requirements.txt
```

## 📝 Directory Structure

```
├── pcap_mix_for.py         # Script for merging and mixing pcap files
├── requirements.txt        # Script for required environment
└── README.md               # This file
```

## 🛠 Usage

The primary script for merging and mixing pcap files is `pcap_mix_for.py`. It combines two pcap files, ensuring packets are merged based on their timestamp order, with special handling for SSH traffic.


## 📜 Notes

- **SSH Traffic**: The tool provides special handling for SSH traffic. If an `ssh.pcap` file is present in the input directories, the packets will be merged using the `twopcapmix_ssh` method, which includes tracking the mix rates.
- **Feature Extraction**: Packet-level features such as packet length and arrival time delta are extracted for analysis and classification tasks.
- **Mixing Strategy**: The tool merges packets based on timestamp order to create realistic mixed traffic scenarios.

